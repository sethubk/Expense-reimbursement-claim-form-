<!-- <h1>International Travel </h1> -->

<div *ngIf="personalData " class="personaldata">
  <p><strong>Date of Submission:</strong> {{ personalData.today }}</p>
  <p><strong>Expense Statement of:</strong> {{ personalData.username }}</p>
  <p><strong>Employee Code:</strong> {{ personalData.employeeCode }}</p>
  <p><strong>Purpose & Place:</strong> {{ personalData.purposePlace }}</p>
  <p><strong>Company & Plant:</strong> {{ personalData.companyPlant }}</p>
  <p><strong>Cost Center:</strong> {{ personalData.costCenter }}</p>
  <p><strong>Vendor Code:</strong> {{ personalData.vendorCode }}</p>
</div>


<div class="first">
  <clr-select-container>
    <label>Select Currency type</label>
    <select clrSelect [(ngModel)]="selectedCurrency" name="currency" (change)="openCurrencyModal()">
      <option value="INR">INR</option>
      <option value="EUR">EUR</option>
      <option value="USD">USD</option>
    </select>
  </clr-select-container>


  <clr-input-container>
    <label>Travel Start Date & Time</label>
    <input clrInput type="datetime-local" [(ngModel)]="travelStart" name="travelStart" required />
  </clr-input-container>

  <clr-input-container>
    <label>Travel End Date & Time</label>
    <input clrInput type="datetime-local" [(ngModel)]="travelEnd" name="travelEnd" required />
  </clr-input-container>



  <div class="numberdays">
    <clr-input-container>
      <label>Number of Days</label>
      <input clrInput type="number" [value]="calculateDays(travelStart, travelEnd)" readonly />
    </clr-input-container>
  </div>
</div>

<!-- Clarity Modal -->
<clr-modal [(clrModalOpen)]="currencyModalOpen">
  <h3 class="modal-title">{{ editIndex !== null ? 'Edit Entry' : 'Add Entry' }}</h3>
  <div class="modal-body">
    <form clrForm #entryForm="ngForm">
      <clr-select-container>
        <label>Type</label>
        <select clrSelect [(ngModel)]="entry.type" name="type" required>
          <option value="Card">Card</option>
          <option value="Cash">Cash</option>
        </select>
      </clr-select-container>

      <clr-input-container>
        <label>INR Rate</label>
        <input clrInput type="number" [(ngModel)]="entry.inrRate" name="inrRate" required />
      </clr-input-container>

      <clr-input-container>
        <label>Total Loaded</label>
        <input clrInput type="number" [(ngModel)]="entry.totalLoaded" name="totalLoaded" required />
      </clr-input-container>

      <clr-input-container>
        <label>Loaded Date</label>
        <input clrInput type="date" [(ngModel)]="entry.loadedDate" name="loadedDate" required />
      </clr-input-container>
    </form>
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary" (click)="saveEntry()">Save</button>
    <button class="btn btn-outline" (click)="currencyModalOpen = false">Cancel</button>
  </div>
</clr-modal>

<!-- Card Table -->
<div class="datagrid-row">
  <!-- Card Table -->
  <div class="datagrid-box">
    <h4>Card Loaded Amount Details</h4>
    <clr-datagrid *ngIf="cardEntries">
      <clr-dg-column>Currency</clr-dg-column>
      <clr-dg-column>INR Rate</clr-dg-column>
      <clr-dg-column>Total Loaded</clr-dg-column>
      <clr-dg-column>Loaded Date</clr-dg-column>
      <clr-dg-column>Total in INR</clr-dg-column>
      <clr-dg-column>Actions</clr-dg-column>

      <clr-dg-row *ngFor="let item of cardEntries ; let i = index">
        <clr-dg-cell>{{ item.currency }}</clr-dg-cell>
        <clr-dg-cell>{{ item.inrRate }}</clr-dg-cell>
        <clr-dg-cell>{{ item.totalLoaded }}</clr-dg-cell>
        <clr-dg-cell>{{ item.loadedDate }}</clr-dg-cell>
        <clr-dg-cell>{{ item.totalInr }}</clr-dg-cell>
        <clr-dg-cell>
          <button class="btn btn-sm btn-link" (click)="editEntry(i, 'Card')">Edit</button>
          <button class="btn btn-sm btn-link btn-outline-danger" (click)="deleteEntry(i, 'Card')">Delete</button>
        </clr-dg-cell>
      </clr-dg-row>
    </clr-datagrid>
  </div>

  <!-- Cash Table -->
  <div class="datagrid-box">
    <h4>Cash Amount Details</h4>
    <clr-datagrid *ngIf="cashEntries">
      <clr-dg-column>Currency</clr-dg-column>
      <clr-dg-column>INR Rate</clr-dg-column>
      <clr-dg-column>Total Loaded</clr-dg-column>
      <clr-dg-column>Loaded Date</clr-dg-column>
      <clr-dg-column>Total in INR</clr-dg-column>
      <clr-dg-column>Actions</clr-dg-column>

      <clr-dg-row *ngFor="let item of cashEntries ; let i = index">
        <clr-dg-cell>{{ item.currency }}</clr-dg-cell>
        <clr-dg-cell>{{ item.inrRate }}</clr-dg-cell>
        <clr-dg-cell>{{ item.totalLoaded }}</clr-dg-cell>
        <clr-dg-cell>{{ item.loadedDate }}</clr-dg-cell>
        <clr-dg-cell>{{ item.totalInr }}</clr-dg-cell>
        <clr-dg-cell>
          <button class="btn btn-sm btn-link" (click)="editEntry(i, 'Cash')">Edit</button>
          <button class="btn btn-sm btn-link btn-outline-danger" (click)="deleteEntry(i, 'Cash')">Delete</button>
        </clr-dg-cell>
      </clr-dg-row>
    </clr-datagrid>
  </div>
</div>


<button class="btn btn-primary" (click)="openmodel()">Fill the International  Claim form </button>

<clr-modal [(clrModalOpen)]="formopen" [clrModalSize]="'md'">
  <div class="modal-body">

    <form clrForm #epenseForm="ngForm" class="expense-form">
      <div class="grid-two">
        <clr-input-container>
          <label>Date</label>
          <input clrInput type="date" [(ngModel)]="formData.date" name="date" required />
        </clr-input-container>

        <clr-input-container>
          <label>Supporting No</label>
          <input clrInput type="text" [(ngModel)]="formData.supportingNo" name="supportingNo" required />
        </clr-input-container>


      </div>
      <div class="grid-two">
        <clr-select-container>
          <label>Particulars</label>
          <select clrSelect [(ngModel)]="formData.particulars" name="particulars" required>
            <option value="Hotel">Hotel</option>
               <option value="Hotel">flight</option>
            <option value="Transport">Transport</option>
            <option value="Food">Food</option>
            <option value="Allowance">Allowance</option>
            <option value="Communication">Communication</option>
            <option value="Visa Process Fees">Visa Process Fees</option>
               <option value="Hotel">	Pre-Travel kit allowance</option>
               <option value="Others">Extra Baggage</option>
            <option value="Others">Others</option>
          </select>
        </clr-select-container>

        <clr-select-container>
          <label>Payment Mode</label>
          <select clrSelect [(ngModel)]="formData.paymentMode" name="paymentMode" required>
            <option value="Cash">Cash</option>
             <option value="CC">CC</option>
              <option value="itilite">itilite</option>
            
          </select>
        </clr-select-container>

      </div>

      <div class="divider"></div>
      <clr-input-container class="amount1">
        <label>Amount</label>
        <input clrInput type="number" [(ngModel)]="formData.amount" name="amount" required />
      </clr-input-container>
      <clr-textarea-container class="remarks-box">
        <label>Remarks</label>
        <textarea clrTextarea [(ngModel)]="formData.remarks" name="remarks"></textarea>
      </clr-textarea-container>



      <div class="divider"></div>
      <div class="actions">
        <button class="submit-btn" [disabled]="!epenseForm.valid" type="button" (click)="addEntry(epenseForm)">
          {{!isEdit? 'add': 'Update'}}</button>
        <button class="btn-outline-danger" type="reset">Reset</button>
      </div>
    </form>


  </div>

</clr-modal>

  <clr-datagrid *ngIf="entries.length > 0">
    <clr-dg-column>Sno</clr-dg-column>
    <clr-dg-column>Date</clr-dg-column>
    <clr-dg-column>Supporting No</clr-dg-column>
    <clr-dg-column>Particulars</clr-dg-column>
    <clr-dg-column>Payment Mode</clr-dg-column>
    <clr-dg-column>Amount</clr-dg-column>
    <clr-dg-column>Remarks</clr-dg-column>
    <clr-dg-column>Screenshot</clr-dg-column>

    <clr-dg-column>Actions</clr-dg-column>

    <clr-dg-row *ngFor="let entry of entries let i = index">
      <clr-dg-cell>{{ i }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.date }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.supportingNo }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.particulars }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.paymentMode }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.amount }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.remarks }}</clr-dg-cell>
      <clr-dg-cell>{{ entry.screenshot }}</clr-dg-cell>
      <clr-dg-cell>
        <button class="crud-btn remove" (click)="removeentry(i)">-</button>
        <button class="crud-btn edit" (click)="Editentry(entry, i)">EDIT</button>
      </clr-dg-cell>


    </clr-dg-row>
  </clr-datagrid>
  <div class="preview">
    <button class="btn btn-primary" *ngIf="entries.length > 0" (click)="gotoreview()"> review </button>
  </div>